# ðŸ”„ Newton-Schulz Iteration: Visual Guide

> Understanding how Muon approximates orthogonalization without computing SVD

## The Big Picture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     GRADIENT MATRIX G (m Ã— n)                           â”‚
â”‚                                                                         â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”      Traditional SVD         â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”        â”‚
â”‚    â”‚  G  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º   â”‚  U  â”‚ â”‚  Î£  â”‚ â”‚ V^T â”‚        â”‚
â”‚    â””â”€â”€â”€â”€â”€â”˜      (expensive O(nÂ³))       â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                              â”‚     â”‚      â”‚             â”‚
â”‚                                              â”‚     â–¼      â”‚             â”‚
â”‚                                              â”‚   [1s]     â”‚             â”‚
â”‚                                              â”‚     â”‚      â”‚             â”‚
â”‚                                              â–¼     â–¼      â–¼             â”‚
â”‚                                           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚                                           â”‚    U Ã— V^T        â”‚         â”‚
â”‚                                           â”‚  (orthogonalized) â”‚         â”‚
â”‚                                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                              vs.

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   NEWTON-SCHULZ ITERATION                               â”‚
â”‚                                                                         â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”                                                              â”‚
â”‚    â”‚  G  â”‚                                                              â”‚
â”‚    â””â”€â”€â”¬â”€â”€â”˜                                                              â”‚
â”‚       â”‚                                                                 â”‚
â”‚       â–¼ normalize                                                       â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”  â”‚
â”‚    â”‚ Xâ‚€  â”‚ â”€â”€â–º â”‚ Xâ‚  â”‚ â”€â”€â–º â”‚ Xâ‚‚  â”‚ â”€â”€â–º â”‚ Xâ‚ƒ  â”‚ â”€â”€â–º â”‚ Xâ‚„  â”‚ â”€â”€â–ºâ”‚ Xâ‚…  â”‚  â”‚
â”‚    â””â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”˜  â”‚
â”‚       â”‚           â”‚           â”‚           â”‚           â”‚          â”‚      â”‚
â”‚       â”‚     polynomial  polynomial  polynomial  polynomial       â”‚      â”‚
â”‚       â”‚     iteration   iteration   iteration   iteration        â”‚      â”‚
â”‚       â”‚                                                          â”‚      â”‚
â”‚       â–¼                                                          â–¼      â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  Each step: X â† aX + (bA + cAA)X  where A = XX^T               â”‚   â”‚
â”‚   â”‚  Converges to orthogonal matrix in ~5 iterations!              â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Step-by-Step Breakdown

### 1ï¸âƒ£ Normalize the Input

```python
X = G / G.norm()  # Scale to unit Frobenius norm
```

This ensures we're in the "basin of convergence" for the iteration.

### 2ï¸âƒ£ Apply the Magic Polynomial (5 times)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                â”‚
â”‚   a = 3.4445                                                   â”‚
â”‚   b = -4.7750                                                  â”‚
â”‚   c = 2.0315                                                   â”‚
â”‚                                                                â”‚
â”‚   For each iteration:                                          â”‚
â”‚                                                                â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”                                                    â”‚
â”‚   â”‚   X   â”‚                                                    â”‚
â”‚   â””â”€â”€â”€â”¬â”€â”€â”€â”˜                                                    â”‚
â”‚       â”‚                                                        â”‚
â”‚       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                 â”‚
â”‚       â”‚                      â”‚                                 â”‚
â”‚       â–¼                      â–¼                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”                             â”‚
â”‚   â”‚ XÂ·X^T â”‚              â”‚  aÂ·X  â”‚                             â”‚
â”‚   â”‚  = A  â”‚              â””â”€â”€â”€â”¬â”€â”€â”€â”˜                             â”‚
â”‚   â””â”€â”€â”€â”¬â”€â”€â”€â”˜                  â”‚                                 â”‚
â”‚       â”‚                      â”‚                                 â”‚
â”‚       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚                                 â”‚
â”‚       â”‚        â”‚             â”‚                                 â”‚
â”‚       â–¼        â–¼             â”‚                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”          â”‚                                 â”‚
â”‚   â”‚ bÂ·A  â”‚ â”‚ cÂ·AÂ² â”‚          â”‚                                 â”‚
â”‚   â””â”€â”€â”¬â”€â”€â”€â”˜ â””â”€â”€â”¬â”€â”€â”€â”˜          â”‚                                 â”‚
â”‚      â”‚        â”‚              â”‚                                 â”‚
â”‚      â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜              â”‚                                 â”‚
â”‚          â”‚                   â”‚                                 â”‚
â”‚          â–¼                   â”‚                                 â”‚
â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”               â”‚                                 â”‚
â”‚      â”‚  BÂ·X  â”‚               â”‚                                 â”‚
â”‚      â””â”€â”€â”€â”¬â”€â”€â”€â”˜               â”‚                                 â”‚
â”‚          â”‚                   â”‚                                 â”‚
â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                 â”‚
â”‚                    â”‚                                           â”‚
â”‚                    â–¼                                           â”‚
â”‚               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                      â”‚
â”‚               â”‚ X_new   â”‚                                      â”‚
â”‚               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                      â”‚
â”‚                                                                â”‚
â”‚   Formula: X_new = aÂ·X + (bÂ·A + cÂ·AÂ²)Â·X                        â”‚
â”‚                                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Why These Specific Numbers?

The coefficients `(3.4445, -4.7750, 2.0315)` come from optimizing a 5th-order polynomial to converge to `sign(X)` (the matrix sign function, which gives orthogonalization).

```
Polynomial:  p(x) = ax + bxÂ³ + cxâµ

At convergence: p maps all singular values to Â±1
                (exactly what we want for orthogonalization!)
```

## Convergence Visualization

```
Singular Values Through Iterations:

     Ïƒ
     â”‚
 1.0 â”¤Â· Â· Â· Â· Â· â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â† All converge to 1
     â”‚        â•±
 0.8 â”¤      â•±  
     â”‚    â•±
 0.6 â”¤  â•±â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     â”‚â•±
 0.4 â”¤â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     â”‚\
 0.2 â”¤  \
     â”‚    \
 0.0 â”¤Â· Â· Â· Â·\â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â† Or converge to 0
     â””â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â–º
         Xâ‚€   Xâ‚   Xâ‚‚   Xâ‚ƒ   Xâ‚„   Xâ‚…    iteration

After 5 iterations: All significant singular values â†’ 1
                    Near-zero singular values â†’ 0
```

## Complete Code with Comments

```python
def newtonschulz5(G, steps=5):
    """
    Approximate orthogonalization using Newton-Schulz iteration.
    
    Input:  G    - gradient matrix (m Ã— n)
    Output: X    - approximately orthogonal matrix
                   where X â‰ˆ UV^T from G = UÎ£V^T
    """
    # Optimal 5th-order polynomial coefficients
    a, b, c = (3.4445, -4.7750, 2.0315)
    
    # Step 1: Normalize (critical for convergence!)
    X = G / G.norm()
    
    # Step 2: Apply polynomial iteration
    for _ in range(steps):
        A = X @ X.T          # Compute XÂ·X^T
        B = b * A + c * A @ A  # Polynomial in A
        X = a * X + B @ X    # Update rule
    
    return X
```

## Memory & Compute Cost

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Operation Counts per Iteration                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                â”‚
â”‚  X @ X.T       â†’  1 matrix multiply  (mÃ—n @ nÃ—m = mÃ—m)        â”‚
â”‚  A @ A         â†’  1 matrix multiply  (mÃ—m @ mÃ—m = mÃ—m)        â”‚
â”‚  B @ X         â†’  1 matrix multiply  (mÃ—m @ mÃ—n = mÃ—n)        â”‚
â”‚  scalar ops    â†’  negligible                                   â”‚
â”‚                                                                â”‚
â”‚  Total: 3 matmuls per iteration Ã— 5 iterations = 15 matmuls   â”‚
â”‚                                                                â”‚
â”‚  Compare to SVD: O(min(m,n)Â³) operations                      â”‚
â”‚  For large matrices: Newton-Schulz is MUCH faster!            â”‚
â”‚                                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Key Insight

> **Newton-Schulz trades exact orthogonalization for speed.**
> 
> We don't need *perfect* orthogonalization â€” we just need to push
> all singular values toward 1. After 5 iterations, we're close enough
> that the optimization benefits are captured.

---

ðŸ“š **See Also:**
- [Deriving Muon](../articles/03-bernstein-deriving-muon.md) - Full mathematical derivation
- [Code Examples](../code-examples/) - Implementation in various frameworks
